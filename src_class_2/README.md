# z2_gz

# Данный раздел посвящен задаче классификации.

### - 'src_class_2' - папка с решением задачи классификации
    - 'models' - папка с моделью
      - 'download_model_classify.sh' - файл для скачивания модели классификации
    - 'model.py' - файл с моделью
    - 'process.py' - файл с предобработкой датасета
    - 'train.py' - скрипт с обучением 
    - 'predict.py' - скрипт с получением предсказанием
    - 'evaluation.py' - скрипт с оценкой точности для проверочного набора данных 
    - 'README.md' - инструкция для использования

## Инструкция:
### Этап обучения:
   1) В папку с проектом необходимо поместить папку с набором данных состоящая из папок clean и noisy (Пример формата: dataset/train/train)
   2) В скрипте "process.py" в переменной INPUT_DIR указать путь до набора данных (Пример: '/home/sheins/z2_gz/dataset/train/train') (Добавить тут parser и корректное взаимодействие с путями) 
      Запусть скрипт. В результате работы он создаст два файла 'x.npy' и 'y.npy' с входными и выходными данным
      соответственно
   3) Для запуска обучнеия по аналогии с пунктом 2 исправиить переменную INPUT_DIR в скрипте 'train.py'. Дополнительно при каждом запуски исправить названия переменных 'checkpoint_path' и название сохраняемой модели в переменной 'save_path'. 
      После обучения модель сохраняется в папке 'models'. 
### Этап классификации:
   1) Полученную модель можно скачать запустив sh скрипт из папки 'models'. Необходимо через терминал открыть папку 'src_class_2/models' и запустить команду:

           sh download_model_classify.sh
   2) Далее для классификации используется скаченная модель. Для получения предсказания можно использовать скрипт 'predict.py' или 'predict.sh', при этом заменив в нем предварительно путь до проверочного примера.
    Альтернативный вариант запустить следующую команду в терминале из папки 'src_class_2'':
    
            python predict.py -f /home/sheins/z2_gz/dataset/val/val/clean/5765/5765_231845_5765-231845-0029.npy
        Путь приведен в качетсве примера
   3) Для оценки (аналогичный скрипт) необходимо запустить скрипт 'evaluation.py' командой:

            python evaluation.py -d /home/sheins/z2_gz/dataset/val/val
   Путь приведен в качетсве примера. Файл 'evaluation.py' содержит parser со следующими флагами:
            
            -m '--model_dir' - путь до модели в формате h5
            -d '--data_dir' - путь до проверочного набора данных хранящийся в папке и разделенный на clean и noisy
   4) В результате работы скрипт выведет результат точности и f1. Текущая точность классификации 0.95975

#### Комментарий: 
Все файлы требуют значительной доработки по соверенствованию взаимодейтсвию модулей, ведению экспериментов и т.д. Ниже минимальный список TODO


# TODO:
- [X] Реализовать заготовку
- [X] Добавить arg parser
- [X] Написать скрипты для запуска
- [X] Добавить скрпт на скачивание модели
- [ ] Добавить CONFIG file
- [ ] Добавить нормальные sh скрипты для запусков
- [ ] Добавить корректное взаимодейтсвие с путями, проверки и т.д.
- [ ] Добавить MakeFile для ведения экспериментов и тд
